% ----------------------------------------------------------
% Modelagem do Projeto
% ----------------------------------------------------------
\chapter{Modelagem do Projeto} \label{cha:modelagem}

% \section{Definição do produto} \label{sec:ctb:definicao}

% O projeto Calltraderbot é um bot que tem como objetivo automatizar  operações de compra e venda de criptomoedas com base em instruções dadas por usuários autorizados, nas contas de usuários clientes de exchanges integradas no referido bot. O mesmo monitora livro de ordens, preço, volume de transações de paridades com ordens criadas e se encarrega de disparar ordens com base 

% Dividido em dois grupos de usuários: Administradores e clientes. Os administradores possuem permissão para criação de instruções, que chamo de \textbf{call}, aonde informa em quais exchanges criar a ordem, o preço de entrada, o preço do alvo e uma porcentagem de perca, para um risco calculado. Os administradores também podem forçar a venda de uma call, ativar e desativar usuários clientes que acompanham seus sinais ou calls, visualizar e exportar relatórios, alterar valores de configurações, bem como todos os comandos disponíveis aos usuários clientes.

% Usuários clientes podem cadastrar chaves de acesso que permite ao bot efetuar operações de compra e venda nas exchanges, realizar um gerenciamento de risco definindo valores como percentual máximo de seu saldo a ser utilizado pelo bot e quantidade de compra por ordem, visualizar saldo, histórico de ordens, ativar e desativar negociações, bem como é notificado automaticamente pelo bot em cada alteração de status de cada ordem.

% Devido ao grande volume de transações, ordens e usuários, se viu a necessidade da criação de um gestor online para visualização dos relatórios já disponibilizados pelo bot, listando calls, ordens, usuários, suas configurações e ordens recebidas, bem como todos os dados referentes a estes elementos.

\section{Levantamento de Requisitos}
\subsection{Requisitos Funcionais}
% Os usuários administradores precisam listar e editar as configurações do canal e seus sinais em andamento, habilitar e desabilitar seus clientes (os usuários seguidores), visualizar indicadores do canal e receber notificações automáticas quando os alvos dos sinais forem atingidos e/ou novos usuários se cadastrarem. Para isso chatbot necessita ter os seguintes requisitos funcionais demonstrados na tabela a seguir:
Existe apenas um tipo de usuário no sistema e é preciso que esteja autenticado para poder utilizar as funcionalidades do sistema: Visualizar saldo, notificações, histórico de operações, ranking de usuários, participar de torneios e efetuar operações de compra e venda de ativos financeiros.

\begin{table}[htbp]
	\scriptsize
	\centering
	\begin{tabular}{|l|l|l|}
		\hline \textbf{Código} & \textbf{Requisito} & \textbf{Descrição} \\ 
		\hline RF1 & Autenticação & Registro e Login utilizando conta da Google \\
		\hline RF2 & Notificações & Receber alertas via sistema de Push Notifications \\
		\hline RF3 & Torneios & Permitir a participação de usuários em torneios \\
		\hline RF4 & Operações & Permitir comprar e vender ativos financeiros disponíveis \\
		\hline RF5 & Histórico e Ranking & Listar histórico de operações do usuário e ranking de usuários cadastrados \\
		\hline 
	\end{tabular}
	\caption{Requisitos funcionais}
	\label{tab:requisitos_funcionais_admin}
\end{table}

\subsection{Requisitos Não Funcionais}

Sobre os requisitos relacionados ao ambiente onde a aplicação está inserida, como: Um servidor mais robusto, medidas de segurança ou um usuário especializado para realização de determinadas ações. Não devem ser ignorados por não fazerem parte diretamente da aplicação, mas devem ser considerados por compor o seu ambiente e, por vezes, determinante para a sua utilização. Como os relacionados na tabela a seguir:

\begin{table}[htbp]
	\scriptsize
	\centering
	\begin{tabular}{|l|l|l|}
		\hline \textbf{Código} & \textbf{Requisito} & \textbf{Descrição} \\ 
		\hline RNF1 & O sistema deve ser simples e intuitivo, provendo rapidez e facilidade nas interações & Usabilidade \\
		\hline RNF2 & A Aplicação deve garantir a identificação do usuário & Segurança \\
		\hline RNF3 & A Aplicação deve realizar as operações de compra e venda em menos de 5 segundos & Desempenho \\
		\hline RNF4 & A Aplicação deve ser compatível com Android 6.0 ou superior & Compatibilidade \\
		\hline 
	\end{tabular}
	\caption{Requisitos não-funcionais}
	\label{tab:requisitos_funcionais_admin}
\end{table}

\section{Diagramas de casos de uso} \label{sec:modelagem:casos}

O diagrama de caso de uso desenvolvido mostrado na figura \ref{fig:uml_caso_uso} descreve as possíveis interações do usuário através da ferramenta.

\begin{figure}[H]
  \caption{\label{fig:uml_caso_uso}Diagrama UML de Casos de Uso}
  \centering
  \includegraphics[scale=1]{imagens/tfc_use_case.pdf}
  \legend{Fonte: Elaborado pelo Autor}
\end{figure}

A partir deste diagrama foi criado os seguintes casos de uso:

\begin{lista}
  \item \textbf{Caso de Uso 01 - Autenticar}: O usuário utilizando sua conta Google autentica-se no sistema;
  \item \textbf{Caso de Uso 02 - Participar de torneios}: O usuário pode competir com outros usuários através de torneios periódicos disponíveis na plataforma;
  \item \textbf{Caso de Uso 03 - Visualizar notificações}: Através da gaveta de notificações o usuário pode visualizar os alertas recebidos;
  \item \textbf{Caso de Uso 04 - Comprar e vender ativos}: O usuário pode negociar ativos financeiro;
  \item \textbf{Caso de Uso 05 - Visualizar histórico}: O usuário pode visualizar o histórico de suas negociações e evolução de seu saldo;
  \item \textbf{Caso de Uso 06 - Visualizar ranking}: É disponibilizado um ranking categórico aos usuários;
  \item \textbf{Caso de Uso 07 - Gerenciar conta}: O usuário pode alterar dados referentes a sua conta;
  \item \textbf{Caso de Uso 08 - Realizar missões}: O usuário visualiza as missões diárias disponíveis a fim de ganhar recompensas;
\end{lista}

Os documentos com as especificações completas estão disponíveis no Anexo \ref{anexo:a} deste trabalho.

\section{Diagramas de classe} \label{sec:modelagem:classe}

O modelo de dados da aplicação apresentado na Figura \ref{fig:uml_der}, onde é apresentado um diagrama UML de classes do projeto model. Estas são as principais entidades do sistema e seus relacionamentos:

\begin{lista}
  \item \textbf{User}: Representa um usuário cadastrado do sistema;
  \item \textbf{Asset}: Representa um ativo financeiro;
  \item \textbf{Belt}: Representa uma categorização do usuário, de acordo com sua performance da negociação de ativos;
  \item \textbf{Tournament}: Representa uma competição entre usuários em um determinado período de tempo;
  \item \textbf{Mission}: Representa um desafio com recompensa a fim de engajar o usuário;
\end{lista}

\section{Arquitetura do Sistema} \label{sec:modelagem:arquitetura}
\section{Diagrama de Entidades-Relacionamentos} \label{sec:modelagem:der}

Na figura \ref{fig:uml_der} podemos ver a estrutura lógica usada como base para o banco de dados.

\begin{figure}[H]
  \caption{\label{fig:uml_der}Diagrama entidade-relacionamento}
  \centering
  \includegraphics[scale=0.5]{imagens/tfc_der.png}
  \legend{Fonte: Elaborado pelo Autor}
\end{figure}

\section{Interface} \label{sec:modelagem:interface}

\subsection{Tela de Autenticação}
Logo que a aplicação é iniciada é verificado se o usuário já possui sessão ativa, caso não é exibido a tela de autenticação, onde o usuário pode:

\begin{lista}
  \item Acessar utilizando suas credenciais da conta Google;
  \item Acessar como anônimo;
\end{lista}

Em qualquer um dos fluxos escolhidos é criado um registro de usuário, caso não o tenha.

\begin{figure}[H]
  \caption{\label{fig:mock_login}Tela de Autenticação}
  \centering
  \includegraphics[scale=0.4]{imagens/mocks/login.png}
  \legend{Fonte: Elaborado pelo Autor}
\end{figure}

\subsection{Tela Principal}
A primeira tela que um usuário autenticado tem acesso é a tela \textit{home} ou tela principal. Nela são exibidos os seguintes elementos:

\begin{lista}
  \item Um avatar do usuário que leva ao perfil do mesmo;
  \item Saldo atual;
  \item Porcentagem de lucro das últimas 24 horas;
  \item Uma seção que informa a categorial atual da conta;
  \item Um \textit{card} com missões que além de desafiar e guiar o usuário, dão recompensas;
  \item Um \textit{card} para compartilhamento do aplicativo nas redes sociais;
  \item Um \textit{card} para compra do plano sem propagandas;
  \item Um \textit{card} para um módulo de ajuda ao usuário;
  \item \textit{Cards} de acesso aos torneios disponíveis;
\end{lista}

Nessa mesma tela, também podemos ver um menu em \textit{tabs} na parte inferior do aplicativo que auxilia na navegação entre as telas: principal, histórico de \textit{trades} e ranking. E na parte superior que da acesso a tela de perfil do usuário.

\begin{figure}[H]
  \caption{\label{fig:mock_login}Tela Principal}
  \centering
  \includegraphics[scale=0.4]{imagens/mocks/main.png}
  \legend{Fonte: Elaborado pelo Autor}
\end{figure}

\subsection{Tela de Perfil}
Na tela de perfil o usuário tem a possibilidade de restaurar seus dados aos valores iniciais, bem como sair da aplicação e tem acesso alguns indicadores, sendo eles:

\begin{lista}
  \item Portfólio: Valor total;
  \item Dinheiro disponível: Valor total disponível para operação de compra e venda;
  \item Performance: Porcentagem comparativa do saldo atual com o saldo inicial;
  \item \textit{Trades}: Total de negociações realizadas;
  \item Ranking Global: Posição referente a performance realizada e comparada com todos os usuários da plataforma;
  \item \textit{Profitable}: Razão de acertos e total de operações;
\end{lista}

\begin{figure}[H]
  \caption{\label{fig:mock_login}Tela Principal}
  \centering
  \includegraphics[scale=0.4]{imagens/mocks/profile.png}
  \legend{Fonte: Elaborado pelo Autor}
\end{figure}

\subsection{Tela de Histórico}
Na tela de histórico o usuário visualiza todas as negociações já realizadas.

\begin{figure}[H]
  \caption{\label{fig:mock_login}Tela de Histórico}
  \centering
  \includegraphics[scale=0.4]{imagens/mocks/history.png}
  \legend{Fonte: Elaborado pelo Autor}
\end{figure}

\subsection{Tela de Ranking}
A tela de ranking dos usuários é ordenada pelo valor total do portfólio, seguido da porcentagem de lucro da conta, nome, país de origem e avatar.

\begin{figure}[H]
  \caption{\label{fig:mock_login}Tela de Ranking}
  \centering
  \includegraphics[scale=0.4]{imagens/mocks/ranking.png}
  \legend{Fonte: Elaborado pelo Autor}
\end{figure}

\subsection{Tela de Negociações}
Nessa tela, o usuário pode fazer praticamente as mesmas coisas da tela principal, podendo clicar no nome do usuário que publicou a receita e ir para o seu perfil. Com um clique, o usuário também pode curtir, comentar e até mesmo favoritar as receitas. A parte mais importante dessa tela são as informações sobre a receita, onde o usuário pode ver, por exemplo, o tempo de preparo e cozimento, o rendimento e a dificuldade, além de ter todas as informações de ingredientes necessários e modo de preparo para fazer a receita.

Na tela de negociações o usuário acompanha a flutuação do preço dos ativos, cria ordens de compra ou venda, a depender do horário de negociações do mesmo. Na barra superior é exibido saldo, sendo atualizado de acordo com as negociações em andamento. Ainda na barra superior, o usuário pode editar quais ativos de sua preferência devem ser exibidos na listagem horizontal que fica no topo da tela.
No gráfico temos informações referente ao valor do ativo, a valorização do mesmo em relação ao fechamento do dia, o preço médio entre compra e venda, bem como a opção de alterar o tempo do gráfico e dois modos de visualização: em linha ou em barras.

\begin{figure}[H]
  \caption{\label{fig:mock_login}Tela de Negociações}
  \centering
  \includegraphics[scale=0.4]{imagens/mocks/tradezone.png}
  \legend{Fonte: Elaborado pelo Autor}
\end{figure}